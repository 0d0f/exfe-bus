{{ if .IsTitleChanged }}{{ .Old_cross.Title }}{{ else }}{{ .Cross.Title }}{{ end }}
//////////////////////////////////

Your ·X· “{{ if .IsTitleChanged }}{{ .Old_cross.Title }}{{ else }}{{ .Cross.Title }}{{ end }}” has been updated{{ if index .By_identities 0 }}{{ with index .By_identities 0 }} by {{ .Name }}{{ end }}{{ end }}.

{{ if .IsTitleChanged }}*{{ end }}{{ .Cross.Title }}{{ if .IsTitleChanged }}*{{ end }}
=======
{{ .Cross.Link .Config.Site_url }}
{{ $time := .Cross.Time.StringInZone .Timezone }}{{ if $time }}
{{ if .IsTimeChanged }}*{{ end }}{{ $time }}{{ if .IsTimeChanged }}*{{ end }}
======={{ else }}
{{ if .IsTimeChanged }}*{{ end }}Time{{ if .IsTimeChanged }}*{{ end }}
=======
  To be decided.{{ end }}

{{ if .IsPlaceChanged }}*{{ end }}{{ if .Cross.Place.Title }}{{ .Cross.Place.Title }}{{ else }}Place{{ end }}{{ if .IsPlaceChanged }}*{{ end }}
=======
  {{ if .Cross.Place.Description }}{{ .Cross.Place.Description }}{{ else }}To be decided.{{ end }}


· {{ .Cross.TotalAccepted }} Accepted:{{ $a := .Cross.Exfee.Invitations }}{{ range $i, $e := $a }}{{ if .IsAccepted }}{{ .Identity.Name }}{{ if .Host }} (Host){{ end }}{{ if last $i $a | not }}, {{ end }}{{ end }}{{ end }}{{ if .Declined }}
· Unavailable: {{ $a := .Declined }}{{ range $i, $e := $a }}{{ .Name }}{{ if last $i $a | not }}, {{ end }}{{ end }}.{{ end }}{{ if .NewlyInvited }}
· Newly invited: {{ $a := .NewlyInvited }}{{ range $i, $e := $a }}{{ if .IsAccepted }}{{ .Identity.Name }}{{ else }}{{ .Identity.Name }}{{ end }}{{ if last $i $a | not }},{{ end }}{{ end }}.{{ end }}{{ if .Removed }}
· Removed: {{ $a := .Removed }}{{ range $i, $e := $a }}{{ .Name }}{{ if last $i $a | not }}, {{ end }}{{ end }}.{{ end }}

{{ $timezone := .Timezone }}{{ range .Posts }}
· {{ .By_identity.Name }} at {{ .CreatedAt $timezone }} said:
    {{ .Content }}{{ end }}
    
{{ if .ManyPosts }}
{{ .Cross.Link .Config.Site_url }}
{{ end }}
# Reply this email directly as conversation. #
//////////////////////////////////

<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <style>
            .exfe_mail_identity_name {
                color: #3a6ea5;
            }
            .exfe_mail_msg_identity_name {
                color: #666666;
            }
            .exfe_mail_msg_at {
                font-size: 12px;
                color: #999999;
            }
            .exfe_mail_msg_time {
                font-size: 12px;
                color: #666666;
            }
        </style>
    </head>
    <body>
        <table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana; font-size: 13px; line-height: 20px; color: #191919; font-weight: normal; width: 640px; padding: 20px; background-color: #fbfbfb;">
            <tr>
                <td colspan="5" style="color: #333333;">
                    Your <span style="color: #3a6ea5;">·X·</span> “<span style="color: #191919;">{{ if .Old_cross }}{{ .Old_cross.Title }}{{ else }}{{ .Cross.Title }}{{ end }}</span>” has been updated{{ with index .By_identities 0 }}{{ if .Name }} by {{ .Name }}{{ end }}{{ end }}.
                </td>
            </tr>
            <tr><td colspan="5" height="10"></td></tr>
            <tr>
                <td colspan="5" style="font-size: 20px; line-height: 26px;">
                    <a href="{{ .Cross.Link .Config.Site_url }}" style="color:{{ if .IsTitleChanged }}#3a6ea5{{ else }}#333333{{ end }}; text-decoration: none; font-weight: lighter;">
                        {{ .Cross.Title }}
                    </a>
                </td>
            </tr>
            <tr><td colspan="5" height="10"></td></tr>
            <tr>
                <td valign="top" width="180">
                    {{ if $time }}
                    <p style="font-size: 20px; line-height: 26px; margin: 0;">
                        <a href="{{ .Cross.Link .Config.Site_url }}" style="color: {{ if .IsTimeChanged }}#3a6ea5{{ else }}#333333{{ end }}; text-decoration: none;">{{ $time }}</a>
                    </p>
                    {{ else }}
                    <p style="font-size: 20px; line-height: 26px; margin: 0;">
                        <a href="{{ .Cross.Link .Config.Site_url }}" style="color: {{ if .IsTimeChanged }}#3a6ea5{{ else }}#333333{{ end }}; text-decoration: none;">Time</a>
                    </p>
                    <p style="margin: 0;">
                        <a href="{{ .Cross.Link .Config.Site_url }}" style="color: {{ if .IsTimeChanged }}#3a6ea5{{ else }}#191919{{ end }}; text-decoration: none;">To be decided</a>
                    </p>
                    {{ end }}
                </td>
                <td></td>
                <td valign="top" width="180" style="word-break: break-all;">
                    {{ if .Cross.Place.Title }}
                    <p style="font-size: 20px; line-height: 26px; margin: 0;">
                        <a href="{{ .Cross.Link .Config.Site_url }}" style="color: {{ if .IsPlaceChanged }}#3a6ea5{{ else }}#333333{{ end }}; text-decoration: none;">{{ .Cross.Place.Title }}</a>
                    </p>
                    <p style="margin: 0;">
                        <a href="{{ .Cross.Link .Config.Site_url }}" style="color: {{ if .IsPlaceChanged }}#3a6ea5{{ else }}#191919{{ end }}; text-decoration: none;">{{ replace .Cross.Place.Description "\n" "<br />"}}</a>
                    </p>
                    {{ else }}
                    <p style="font-size: 20px; line-height: 26px; margin: 0;">
                        <a href="{{ .Cross.Link .Config.Site_url }}" style="color: {{ if .IsPlaceChanged }}#3a6ea5{{ else }}#333333{{ end }}; text-decoration: none;">Place</a>
                    </p>
                    <p style="margin: 0;">
                        <a href="{{ .Cross.Link .Config.Site_url }}" style="color: {{ if .IsPlaceChanged }}#3a6ea5{{ else }}#191919{{ end }}; text-decoration: none;">To be decided</a>
                    </p> 
                    {{ end }}
                </td>
                <td></td>
                <td valign="top" width="180">
                    <!--Map-->
                </td>
            </tr>
            <tr><td colspan="5" height="10"></td></tr>
            <tr>
                <td colspan="5">
                    <table border="0" cellpadding="0" cellspacing="0" style="font-family: Verdana; font-size: 13px; line-height: 20px; color: #191919; font-weight: normal; width: 640px; background-color: #fbfbfb;">
                        {{ if .Accepted }}
                        <tr>
                            <td width="15"><img src="{{ .Config.Site_img }}/email/rsvp_accepted_12_blue.png" /></td>
                            <td>
                                <a href="{{ .Cross.Link .Config.Site_url }}" style="color: #191919; text-decoration: none;">
                                    <p style="margin: 0;">
                                        <span class="exfe_mail_identity_name">{{ .Cross.TotalAccepted }}</span> Accepted: {{ $a := .Accepted }}{{ range $i, $e := $a }}<span class="exfe_mail_identity_name">{{ .Identity.Name }}</span>{{ if last $i $a | not }}, {{ end }}{{ end }} and {{ .OldAccepted }} others.
                                    </p>
                                </a>
                            </td>
                        </tr>
                        {{ end }}
                        {{ if .Declined }}
                        <tr>
                            <td width="15"><img src="{{ .Config.Site_img }}/email/rsvp_declined_12.png" /></td>
                            <td>
                                <a href="{{ .Cross.Link .Config.Site_url }}" style="color: #191919; text-decoration: none;">
                                    <p style="margin: 0;">
                                        Unavailable: {{ $a := .Declined }}{{ range $i, $e := $a }}{{ .Name }}{{ if last $i $a | not }}, {{ end }}{{ end }}.
                                    </p>
                                </a>
                            </td>
                        </tr>
                        {{ end }}
                        {{ if .NewlyInvited }}
                        <tr>
                            <td width="15"><img src="{{ .Config.Site_img }}/email/plus_12_blue.png" /></td>
                            <td>
                                <a href="{{ .Cross.Link .Config.Site_url }}" style="color: #191919; text-decoration: none;">
                                    <p style="margin: 0;">
                                        Newly invited: {{ $a := .NewlyInvited }}{{ range $i, $e := $a }}{{ if .IsAccepted }}<span class="exfe_mail_identity_name">{{ .Identity.Name }}</span>{{ else }}{{ .Identity.Name }}{{ end }}{{ if last $i $a | not }}, {{ end }}{{ end }}.
                                    </p>
                                </a>
                            </td>
                        </tr>
                        {{ end }}
                        {{ if .Removed }}
                        <tr>
                            <td width="15"><img src="{{ .Config.Site_img }}/email/minus_12.png" /></td>
                            <td>
                                <a href="{{ .Cross.Link .Config.Site_url }}" style="color: #191919; text-decoration: none;">
                                    <p style="margin: 0;">
                                        Removed: {{ $a := .Removed }}{{ range $i, $e := $a }}{{ .Name }}{{ if last $i $a | not }}, {{ end }}{{ end }}.
                                    </p>
                                </a>
                            </td>
                        </tr>
                        {{ end }}
                    </table>
                </td>
            </tr>
            <tr><td colspan="5" height="10"></td></tr>
            <tr>
                <td colspan="5">
                    {{ $api := .Config.Site_api }}
                    {{ range .Cross.Exfee.Invitations }}
                    <img style="padding-right: 5px;" width="40" height="40" alt="{{ .Identity.Name }}" title="{{ .Identity.Name }}" src="{{ $api }}/v2/avatar/render?url={{ .Identity.Avatar_filename | base64 | urlquery }}&width=40&height=40{{ if not .IsAccepted }}&alpha=0.33{{ end }}{{ if .Host }}&ishost=true{{ end }}{{ if .Mates }}&mates={{ .Mates }}{{ end }}">
                    {{ end }}
                </td>
            </tr>
            {{ if .Posts }}
            <tr><td colspan="5" height="10"></td></tr>
            <tr><td colspan="5" height="1" background="{{ .Config.Site_img }}/email/dash.png"></td></tr>
            <tr><td colspan="5" height="20"></td></tr>
            <tr>
                <td colspan="5">
                    <table border="0" cellpadding="0" cellspacing="0">
                        {{ $timezone := .Timezone }}{{ $url := .Cross.Link .Config.Site_url }}
                        {{ range .Posts }}
                        <tr>
                            <td valign="top" width="50" align="left">
                                <img width="40" height="40" title="{{ .By_identity.Name }}" alt="{{ .By_identity.Name }}" src="{{ .By_identity.Avatar_filename }}">
                            </td>
                            <td valign="top">
                                <a href="{{ $url }}" style="text-decoration: none;">
                                    <span style="color:#212121; text-decoration: none;">{{ .Content }}</span>
                                    <br />
                                    <span style="font-size: 12px; color:#797979; text-decoration: none;">{{ .By_identity.Name }}</span> <span style="font-size: 12px; color:#A9A9A9; text-decoration: none;">at</span> <span  style="font-size: 12px; color:#797979; text-decoration: none;">{{ .CreatedAt $timezone }}</span>
                                </a>
                            </td>
                        </tr>
                        <tr><td colspan="2" height="20"></td></tr>
                        {{ end }}
                    </table>
                </td>
            </tr>
            {{ end }}
            <tr><td colspan="5" height="20"></td></tr>
            <tr>
                <td colspan="5" style="font-size: 11px; line-height: 15px; color: #7F7F7F;">
                    Reply this email directly as conversation.<!--, or try <a style="color: #3a6ea5; text-decoration: none;" href="{{ .Config.App_url }}">EXFE</a> app.-->
                    <br />
                    <span style="color: #B2B2B2">This update is sent from <a style="color: #3a6ea5; text-decoration: none;" href="{{ .Config.Site_url }}">EXFE</a> automatically. <a style="color: #E6E6E6; text-decoration: none;" href="{{ .Config.Site_url }}/s/reportSpam?token={{ .Token }}">Unsubscribe?</a>
                    <!--
                    You can change
                    <a style="color: #B2B2B2; text-decoration: undeline;" href="">notification preference</a>.
                    -->
                    </span>
                </td>
            </tr>
        </table>
    </body>
</html>
